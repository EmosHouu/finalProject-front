import{a8 as N,y as q,z as H,r as C,T as M,A as m,B as v,C as t,c as a,H as f,a9 as h,D as r,P as o,N as P,O as U,F as L,M as O,W as D,aa as _,K as l,E as g,I as $,V as z,Q as K,R as Q}from"./index-e083f985.js";import{u as W,a as j}from"./axios-7c120cc4.js";import{c as G,g as J,u as X,V as Y}from"./index.esm-305a631b.js";import{_ as Z}from"./_plugin-vue_export-helper-b3df6827.js";import{V as ee,a as b,b as T}from"./VRow-0229d952.js";import{a as te,V as ae}from"./VCarouselItem-10ddde15.js";import{V as w}from"./VChip-94e092f9.js";import"./axios-a342f982.js";import"./ssrBoot-64e91b7a.js";import"./VSlideGroup-a9995a70.js";const u=n=>(K("data-v-c287dbbf"),n=n(),Q(),n),se={class:"description"},le=u(()=>r("br",null,null,-1)),oe=u(()=>r("br",null,null,-1)),re=u(()=>r("br",null,null,-1)),ie=u(()=>r("br",null,null,-1)),ue=u(()=>r("br",null,null,-1)),ne={class:"d-flex"},ce=u(()=>r("br",null,null,-1)),de=u(()=>r("h2",null,"活動描述",-1)),me={__name:"ActDetail",setup(n){const x=N(),S=q(),{api:k,apiAuth:B}=j(),y=H(),V=W(),c=C(!1),e=C({_id:"",name:"",description:"",images:"[]",category:"",startDate:"",endDate:"",startTime:"",endTime:"",participants:"",area:"",location:""}),E=G({quantity:J().typeError("缺少數量").required("缺少數量").min(1,"數量最小為 1")}),{isSubmitting:F,handleSubmit:A}=X({validationSchema:E,initialValues:{quantity:1}}),I=A(async s=>{var p,d;if(!V.isLogin){S.push("/");return}try{const{data:i}=await B.patch("/users/cart",{activity:e.value._id,quantity:1});V.cart=i.result,c.value=!0,console.log(c.value),y({text:"報名成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})}catch(i){const R=((d=(p=i==null?void 0:i.response)==null?void 0:p.data)==null?void 0:d.message)||"發生錯誤，請稍後再試";y({text:R,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return M(async()=>{try{const{data:s}=await k.get("/activity/"+x.params.id);e.value._id=s.result._id,e.value.name=s.result.name,e.value.category=s.result.category,e.value.description=s.result.description,e.value.area=s.result.area,e.value.images=s.result.images,e.value.startDate=s.result.startDate,e.value.startTime=s.result.startTime,e.value.endDate=s.result.endDate,e.value.endTime=s.result.endTime,e.value.participants=s.result.participants,e.value.location=s.result.location,console.log("activity",e.value)}catch(s){console.log(s),console.error("Error fetching activity data:",s)}}),(s,p)=>(m(),v(ee,null,{default:t(()=>[a(T,{class:"align-stretch"},{default:t(()=>[a(b,{cols:"12",md:"8"},{default:t(()=>[a(f,{color:"#FFEFE8"},{default:t(()=>[a(h,null,{default:t(()=>[r("h2",null,o(e.value.name),1)]),_:1}),e.value.images.length>0?(m(),v(te,{key:0,"show-arrows":"hover","hide-delimiter-background":""},{default:t(()=>[(m(!0),P(L,null,U(e.value.images,(d,i)=>(m(),v(ae,{key:i,src:d,height:"500",cover:""},null,8,["src"]))),128))]),_:1})):O("",!0)]),_:1})]),_:1}),a(b,{cols:"12",md:"4"},{default:t(()=>[a(f,{height:"100%",color:"#FFEFE8"},{default:t(()=>[a(h),a(D,null,{default:t(()=>[r("div",se,[a(_,null,{default:t(()=>[l("mdi-account")]),_:1}),l(" 團長：HARU HOU "),le,a(_,null,{default:t(()=>[l("mdi-calendar")]),_:1}),l(" 活動時間："),oe,l(" "+o(e.value.startDate)+" "+o(e.value.startTime)+" ~ "+o(e.value.endDate)+" "+o(e.value.endTime),1),re,a(_,null,{default:t(()=>[l("mdi-map-marker")]),_:1}),l(" "+o(e.value.location)+" ",1),ie,a(_,null,{default:t(()=>[l(" mdi-account-group")]),_:1}),l(" 活動人數:"+o(e.value.participants)+"人 已報名：3人",1),ue]),r("div",ne,[a(w,{style:{marginRight:"10px"},color:"#FFD4C0",variant:"flat"},{default:t(()=>[l(o(e.value.category),1)]),_:1}),a(w,{color:"#FFD4C0",variant:"flat"},{default:t(()=>[l(o(e.value.area),1)]),_:1})]),ce,a(Y,{disabled:g(F),onSubmit:$(g(I),["prevent"])},{default:t(()=>[a(z,{color:"#F8B44B",type:"submit",loading:g(F),disabled:c.value.value},{default:t(()=>[l(o(c.value.value?"已报名":"我要参加"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1}),a(T,null,{default:t(()=>[a(b,{cols:"12"},{default:t(()=>[a(f,{color:"#FFEFE8"},{default:t(()=>[a(h,null,{default:t(()=>[de]),_:1}),a(D,{style:{"white-space":"pre"},class:"description"},{default:t(()=>[l(o(e.value.description),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}},Ce=Z(me,[["__scopeId","data-v-c287dbbf"]]);export{Ce as default};
