import{p as ne,Q as D,m as se,bV as oe,a as ue,bS as ie,g as re,aD as ce,aE as ve,aY as fe,ak as k,e as g,aG as j,bs as de,U as pe,b as me,c as b,ap as B,M as N,bp as he,ax as ge,bW as Se,r as x}from"./index-879e0d86.js";import{a as E}from"./axios-a342f982.js";function W(e){const s=Math.abs(e);return Math.sign(e)*(s/((1/.501-2)*(1-s)+1))}function $(e){let{selectedElement:o,containerSize:s,contentSize:u,isRtl:S,currentScrollOffset:c,isHorizontal:n}=e;const i=n?o.clientWidth:o.clientHeight,l=n?o.offsetLeft:o.offsetTop,v=S&&n?u-l-i:l,f=s+c,r=i+v,y=i*.4;return v<=c?c=Math.max(v-y,0):f<=r&&(c=Math.min(c-(f-r-y),u-s)),c}function ye(e){let{selectedElement:o,containerSize:s,contentSize:u,isRtl:S,isHorizontal:c}=e;const n=c?o.clientWidth:o.clientHeight,i=c?o.offsetLeft:o.offsetTop,l=S&&c?u-i-n/2-s/2:i+n/2-s/2;return Math.min(u-s,Math.max(0,l))}const be=Symbol.for("vuetify:v-slide-group"),xe=ne({centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:be},nextIcon:{type:D,default:"$next"},prevIcon:{type:D,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...se(),...oe(),...ue(),...ie({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),Ae=re()({name:"VSlideGroup",props:xe(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:s}=o;const{isRtl:u}=ce(),{displayClasses:S,mobile:c}=ve(e),n=fe(e,e.symbol),i=k(!1),l=k(0),v=k(0),f=k(0),r=g(()=>e.direction==="horizontal"),{resizeRef:y,contentRect:d}=j(),{resizeRef:p,contentRect:P}=j(),M=g(()=>n.selected.value.length?n.items.value.findIndex(t=>t.id===n.selected.value[0]):-1),Y=g(()=>n.selected.value.length?n.items.value.findIndex(t=>t.id===n.selected.value[n.selected.value.length-1]):-1);if(de){let t=-1;pe(()=>[n.selected.value,d.value,P.value,r.value],()=>{cancelAnimationFrame(t),t=requestAnimationFrame(()=>{if(d.value&&P.value){const a=r.value?"width":"height";v.value=d.value[a],f.value=P.value[a],i.value=v.value+1<f.value}if(M.value>=0&&p.value){const a=p.value.children[Y.value];M.value===0||!i.value?l.value=0:e.centerActive?l.value=ye({selectedElement:a,containerSize:v.value,contentSize:f.value,isRtl:u.value,isHorizontal:r.value}):i.value&&(l.value=$({selectedElement:a,containerSize:v.value,contentSize:f.value,isRtl:u.value,currentScrollOffset:l.value,isHorizontal:r.value}))}})})}const R=k(!1);let V=0,C=0;function X(t){const a=r.value?"clientX":"clientY";C=(u.value&&r.value?-1:1)*l.value,V=t.touches[0][a],R.value=!0}function K(t){if(!i.value)return;const a=r.value?"clientX":"clientY",m=u.value&&r.value?-1:1;l.value=m*(C+V-t.touches[0][a])}function J(t){const a=f.value-v.value;l.value<0||!i.value?l.value=0:l.value>=a&&(l.value=a),R.value=!1}function Q(){y.value&&(y.value[r.value?"scrollLeft":"scrollTop"]=0)}const w=k(!1);function Z(t){if(w.value=!0,!(!i.value||!p.value)){for(const a of t.composedPath())for(const m of p.value.children)if(m===a){l.value=$({selectedElement:m,containerSize:v.value,contentSize:f.value,isRtl:u.value,currentScrollOffset:l.value,isHorizontal:r.value});return}}}function ee(t){w.value=!1}function te(t){var a;!w.value&&!(t.relatedTarget&&((a=p.value)!=null&&a.contains(t.relatedTarget)))&&h()}function le(t){p.value&&(r.value?t.key==="ArrowRight"?h(u.value?"prev":"next"):t.key==="ArrowLeft"&&h(u.value?"next":"prev"):t.key==="ArrowDown"?h("next"):t.key==="ArrowUp"&&h("prev"),t.key==="Home"?h("first"):t.key==="End"&&h("last"))}function h(t){var a,m,G,H,L;if(p.value)if(!t)(a=he(p.value)[0])==null||a.focus();else if(t==="next"){const z=(m=p.value.querySelector(":focus"))==null?void 0:m.nextElementSibling;z?z.focus():h("first")}else if(t==="prev"){const z=(G=p.value.querySelector(":focus"))==null?void 0:G.previousElementSibling;z?z.focus():h("last")}else t==="first"?(H=p.value.firstElementChild)==null||H.focus():t==="last"&&((L=p.value.lastElementChild)==null||L.focus())}function T(t){const a=l.value+(t==="prev"?-1:1)*v.value;l.value=ge(a,0,f.value-v.value)}const ae=g(()=>{let t=l.value>f.value-v.value?-(f.value-v.value)+W(f.value-v.value-l.value):-l.value;l.value<=0&&(t=W(-l.value));const a=u.value&&r.value?-1:1;return{transform:`translate${r.value?"X":"Y"}(${a*t}px)`,transition:R.value?"none":"",willChange:R.value?"transform":""}}),I=g(()=>({next:n.next,prev:n.prev,select:n.select,isSelected:n.isSelected})),O=g(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!c.value;case!0:return i.value||Math.abs(l.value)>0;case"mobile":return c.value||i.value||Math.abs(l.value)>0;default:return!c.value&&(i.value||Math.abs(l.value)>0)}}),F=g(()=>Math.abs(l.value)>0),U=g(()=>f.value>Math.abs(l.value)+v.value);return me(()=>b(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!r.value,"v-slide-group--has-affixes":O.value,"v-slide-group--is-overflowing":i.value},S.value,e.class],style:e.style,tabindex:w.value||n.selected.value.length?-1:0,onFocus:te},{default:()=>{var t,a,m;return[O.value&&b("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!F.value}],onClick:()=>F.value&&T("prev")},[((t=s.prev)==null?void 0:t.call(s,I.value))??b(B,null,{default:()=>[b(N,{icon:u.value?e.nextIcon:e.prevIcon},null)]})]),b("div",{key:"container",ref:y,class:"v-slide-group__container",onScroll:Q},[b("div",{ref:p,class:"v-slide-group__content",style:ae.value,onTouchstartPassive:X,onTouchmovePassive:K,onTouchendPassive:J,onFocusin:Z,onFocusout:ee,onKeydown:le},[(a=s.default)==null?void 0:a.call(s,I.value)])]),O.value&&b("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!U.value}],onClick:()=>U.value&&T("next")},[((m=s.next)==null?void 0:m.call(s,I.value))??b(B,null,{default:()=>[b(N,{icon:u.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:n.selected,scrollTo:T,scrollOffset:l,focus:h}}}),_={USER:0,ADMIN:1},q=Se("user",()=>{const{apiAuth:e}=ke(),o=x(""),s=x(""),u=x(""),S=x(""),c=x(""),n=x(0),i=x(_.USER),l=d=>{d.token&&(u.value=d.token),o.value=d._id,s.value=d.name,S.value=d.account,c.value=d.email,n.value=d.cart,i.value=d.role},v=g(()=>u.value.length>0),f=g(()=>i.value===_.ADMIN),r=async()=>{if(u.value.length!==0)try{const{data:d}=await e.get("/users/me");l(d.result)}catch{y()}},y=()=>{u.value="",o.value="",S.value="",c.value="",n.value=0,i.value=_.USER};return{_id:o,name:s,token:u,account:S,email:c,cart:n,role:i,login:l,logout:y,isLogin:v,isAdmin:f,getProfile:r}},{persist:{key:"20240126",paths:["token"]}}),ze=E.create({baseURL:"https://finalproject-back-emoshou.onrender.com"}),A=E.create({baseURL:"https://finalproject-back-emoshou.onrender.com"});A.interceptors.request.use(e=>{const o=q();return e.headers.Authorization="Bearer "+o.token,e});A.interceptors.response.use(e=>e,e=>{if(e.response&&e.response.data.message==="JWT 過期"&&e.config.url!=="/users/extend"){const o=q();return A.patch("/users/extend").then(({data:s})=>(o.token=s.result,e.config.headers.Authorization="Bearer "+o.token,E(e.config))).catch(()=>(o.logout(),Promise.reject(e)))}return Promise.reject(e)});const ke=()=>({api:ze,apiAuth:A});export{Ae as V,ke as a,xe as m,q as u};
