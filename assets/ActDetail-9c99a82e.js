import{J as R,d as q,l as N,r as C,G as L,o as m,f as v,w as t,c as a,k as h,K as g,h as r,A as o,y as M,z as P,F as U,x as H,L as D,M as _,t as l,i as y,n as $,s as z,B as G,C as J}from"./index-879e0d86.js";import{u as K,a as O}from"./axios-d2c960a5.js";import{c as j,g as Q,u as W,V as X}from"./index.esm-a8bec034.js";import{_ as Y}from"./_plugin-vue_export-helper-7c9dc567.js";import{V as Z,a as w}from"./VRow-29d9277e.js";import{V as b}from"./VCol-880b9827.js";import{V as ee,a as te}from"./VCarouselItem-93211952.js";import{V as x}from"./VChip-a388a6b6.js";import"./axios-a342f982.js";import"./ssrBoot-2888e2b8.js";const u=n=>(G("data-v-ff3c2cf2"),n=n(),J(),n),ae={class:"description"},se=u(()=>r("br",null,null,-1)),le=u(()=>r("br",null,null,-1)),oe=u(()=>r("br",null,null,-1)),re=u(()=>r("br",null,null,-1)),ie=u(()=>r("br",null,null,-1)),ue={class:"d-flex"},ne=u(()=>r("br",null,null,-1)),ce=u(()=>r("h2",null,"活動描述",-1)),de={__name:"ActDetail",setup(n){const k=R();q();const{api:B,apiAuth:S}=O(),p=N(),V=K(),c=C(!1),e=C({_id:"",name:"",description:"",images:"[]",category:"",startDate:"",endDate:"",startTime:"",endTime:"",participants:"",area:"",location:""}),T=j({quantity:Q().typeError("缺少數量").required("缺少數量").min(1,"數量最小為 1")}),{isSubmitting:F,handleSubmit:E}=W({validationSchema:T,initialValues:{quantity:1}}),A=E(async s=>{var f,d;if(!V.isLogin){p({text:"請先登入",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}try{const{data:i}=await S.patch("/users/cart",{activity:e.value._id,quantity:1});V.cart=i.result,c.value=!0,console.log(c.value),p({text:"報名成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})}catch(i){const I=((d=(f=i==null?void 0:i.response)==null?void 0:f.data)==null?void 0:d.message)||"發生錯誤，請稍後再試";p({text:I,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return L(async()=>{try{const{data:s}=await B.get("/activity/"+k.params.id);e.value._id=s.result._id,e.value.name=s.result.name,e.value.category=s.result.category,e.value.description=s.result.description,e.value.area=s.result.area,e.value.images=s.result.images,e.value.startDate=s.result.startDate,e.value.startTime=s.result.startTime,e.value.endDate=s.result.endDate,e.value.endTime=s.result.endTime,e.value.participants=s.result.participants,e.value.location=s.result.location,console.log("activity",e.value)}catch(s){console.log(s),console.error("Error fetching activity data:",s)}}),(s,f)=>(m(),v(Z,null,{default:t(()=>[a(w,{class:"align-stretch"},{default:t(()=>[a(b,{cols:"12",md:"8"},{default:t(()=>[a(h,{color:"#FFEFE8"},{default:t(()=>[a(g,null,{default:t(()=>[r("h2",null,o(e.value.name),1)]),_:1}),e.value.images.length>0?(m(),v(ee,{key:0,"show-arrows":"hover","hide-delimiter-background":""},{default:t(()=>[(m(!0),M(U,null,P(e.value.images,(d,i)=>(m(),v(te,{key:i,src:d,height:"500",cover:""},null,8,["src"]))),128))]),_:1})):H("",!0)]),_:1})]),_:1}),a(b,{cols:"12",md:"4"},{default:t(()=>[a(h,{height:"100%",color:"#FFEFE8"},{default:t(()=>[a(g),a(D,null,{default:t(()=>[r("div",ae,[a(_,null,{default:t(()=>[l("mdi-account")]),_:1}),l(" 團長：HARU HOU "),se,a(_,null,{default:t(()=>[l("mdi-calendar")]),_:1}),l(" 活動時間："),le,l(" "+o(e.value.startDate)+" "+o(e.value.startTime)+" ~ "+o(e.value.endDate)+" "+o(e.value.endTime),1),oe,a(_,null,{default:t(()=>[l("mdi-map-marker")]),_:1}),l(" "+o(e.value.location)+" ",1),re,a(_,null,{default:t(()=>[l(" mdi-account-group")]),_:1}),l(" 活動人數:"+o(e.value.participants)+"人 已報名：3人",1),ie]),r("div",ue,[a(x,{style:{marginRight:"10px"},color:"#FFD4C0",variant:"flat"},{default:t(()=>[l(o(e.value.category),1)]),_:1}),a(x,{color:"#FFD4C0",variant:"flat"},{default:t(()=>[l(o(e.value.area),1)]),_:1})]),ne,a(X,{disabled:y(F),onSubmit:$(y(A),["prevent"])},{default:t(()=>[a(z,{color:"#F8B44B",type:"submit",loading:y(F),disabled:c.value.value},{default:t(()=>[l(o(c.value.value?"已报名":"我要参加"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1}),a(w,null,{default:t(()=>[a(b,{cols:"12"},{default:t(()=>[a(h,{color:"#FFEFE8"},{default:t(()=>[a(g,null,{default:t(()=>[ce]),_:1}),a(D,{style:{"white-space":"pre"},class:"description"},{default:t(()=>[l(o(e.value.description),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}},Fe=Y(de,[["__scopeId","data-v-ff3c2cf2"]]);export{Fe as default};
